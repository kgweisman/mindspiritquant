---
title: "Study 4: Extra analyses (not reported)"
subtitle: "Luhrmann, Weisman, et al."
output: 
  html_notebook:
    theme: flatly
    toc: true
    toc_float: true
---

In this notebook, we conducted extra analyses (not reported) for Study 4: Confirmatory work with undergraduates.

```{r}
source("../../scripts_general/dependencies.R")
source("../../scripts_general/custom_funs.R")
source("../../scripts_general/var_recode_contrast.R")
```

```{r}
theme_set(theme_bw())
```

```{r}
d4_byquestion_raw <- read_csv("../data/study4_byquestion.csv") %>%
  select(-X1) %>%
  mutate(p7_ctry = factor(p7_ctry, levels = levels_country))

source("../scripts_s4/s4_var_groups.R")
```

```{r}
d4_byquestion <- full_join(d4_byquestion_raw %>%
                             select(p7_ctry, p7_subj, s4_var_pv) %>%
                             gather(question, response, s4_var_pv) %>%
                             mutate(scale = "pv_score"),
                           d4_byquestion_raw %>%
                             select(p7_ctry, p7_subj, s4_var_por) %>%
                             gather(question, response, s4_var_por) %>%
                             mutate(scale = "por_score")) %>%
  full_join(d4_byquestion_raw %>%
              select(p7_ctry, p7_subj, s4_var_abs) %>%
              gather(question, response, s4_var_abs) %>%
              mutate(scale = "abs_score")) %>%
  full_join(d4_byquestion_raw %>%
              select(p7_ctry, p7_subj, s4_var_dse) %>%
              gather(question, response, s4_var_dse) %>%
              mutate(scale = "dse_score")) %>%
  full_join(d4_byquestion_raw %>%
              select(p7_ctry, p7_subj, s4_var_spev) %>%
              gather(question, response, s4_var_spev) %>%
              mutate(scale = "spev_score")) %>%
  full_join(d4_byquestion_raw %>%
              select(p7_ctry, p7_subj, s4_var_hall) %>%
              gather(question, response, s4_var_hall) %>%
              mutate(scale = "hall_score")) %>%
  full_join(d4_byquestion_raw %>%
              select(p7_ctry, p7_subj, s4_var_para) %>%
              gather(question, response, s4_var_para) %>%
              mutate(scale = "para_score")) %>%
  full_join(d4_byquestion_raw %>%
              select(p7_ctry, p7_subj, s4_var_cog) %>%
              gather(question, response, s4_var_cog) %>%
              mutate(scale = "cog_score")) %>%
  full_join(d4_byquestion_raw %>%
              select(p7_ctry, p7_subj, s4_var_ctl) %>%
              gather(question, response, s4_var_ctl) %>%
              mutate(scale = "ctl_score")) %>%
  mutate(p7_ctry = factor(p7_ctry, levels = levels_country))
```

```{r}
d4_0 <- d4_byquestion %>%
  group_by(p7_subj, scale) %>%
  mutate(score = mean(response, na.rm = T)) %>%
  ungroup() %>%
  mutate(study = "study 4") %>%
  distinct(study, p7_ctry, p7_subj, scale, score) %>%
  spread(scale, score)

d4_std <- d4_0 %>%
  group_by(study) %>%
  mutate_at(vars(ends_with("_score")), funs(std = scale)) %>%
  ungroup()

d4_std2 <- d4_0 %>%
  group_by(study, p7_ctry) %>%
  mutate_at(vars(ends_with("_score")), funs(std2 = scale)) %>%
  ungroup()

d4 <- d4_0 %>% full_join(d4_std) %>% full_join(d4_std2) %>%
  mutate(p7_ctry = factor(p7_ctry, levels = levels_country))
```

```{r}
contrasts(d4_byquestion$p7_ctry) <- contrasts_country
contrasts(d4$p7_ctry) <- contrasts_country
```

## Attempting to fit more complex random effects structures

```{r}
# more complex random effects structures: NOT REPORTED
# note: never looking for intercepts (random or fixed) by scale, because standardized
r1a <- lmer(spirit_score_std ~ 1 + abs_score_std +
              (1 | p7_ctry/p7_subj) +
              (0 + abs_score_std | p7_ctry) +
              (0 + abs_score_std | spirit_scale),
            data = d4_long) # singular

r1b <- lmer(spirit_score_std ~ 1 + abs_score_std +
              (1 | p7_ctry/p7_subj) +
              (0 + abs_score_std | p7_ctry),
            data = d4_long) # singular

r1c <- lmer(spirit_score_std ~ 1 + abs_score_std +
              (1 | p7_ctry/p7_subj) +
              (0 + abs_score_std | spirit_scale),
            data = d4_long) # failed to converge

r1d <- lmer(spirit_score_std ~ abs_score_std + 
              (0 + abs_score_std | p7_ctry) +
              (0 + abs_score_std | spirit_scale),
            data = d4_long) # fine, but doesn't reflect repeated measures design

r1e <- lmer(spirit_score_std ~ 1 + abs_score_std +
              (1 + abs_score_std | p7_ctry), # singular
            # (1 + abs_score_std || p7_ctry), # failed to converge
            data = d4_long) # singular

r1f <- lmer(spirit_score_std ~ 1 + abs_score_std +
              (1 | p7_ctry/p7_subj),
            data = d4_long) # fine, but doesn't account for two scales

r1g <- lmer(spirit_score_std ~ 1 + abs_score_std +
              (0 + abs_score_std | spirit_scale),
            data = d4_long) # overparameterized: only 1 df for testing main effect of abs_score

r1h <- lmer(spirit_score_std ~ 1 + abs_score_std +
              (1 + abs_score_std | p7_ctry) + (1 | p7_subj),
            data = d4_long) # singular
```

```{r}
r1i_dse <- lmer(dse_score_std ~ abs_score_std +
                  (1 + abs_score_std | p7_ctry), d4) # singular

r1i_spev <- lmer(spev_score_std ~ abs_score_std +
                   (1 + abs_score_std | p7_ctry), d4) # singular
```



## Primary analysis

### Daily Spiritual Experiences

```{r}
r1_dse <- lmer(dse_score_std ~ abs_score_std + 
                 (1 + abs_score_std || p7_ctry), d4)
summary(r1_dse)
```

```{r}
rsquared(r1_dse)
```

```{r}
regtab_fun(r1_dse) %>%
  kable(align = c(rep("r", ncol(.) - 1), "l")) %>%
  kable_styling(font_size = 16) %>%
  row_spec(2, bold = T) %>%
  row_spec(1:nrow(regtab_fun(r1_dse)), color = "black")
```

```{r}
# regtab_ran_fun(r1_dse) %>%
#   mutate(Group = case_when(is.na(Group) ~ "Participant, nested within p7_ctry",
#                            TRUE ~ as.character(Group)),
#          Group = factor(Group, levels = c("p7_ctry", 
#                                           "Participant, nested within p7_ctry", 
#                                           "Residual"))) %>%
#   arrange(Group) %>%
#   kable(align = "r") %>%
#   kable_styling(font_size = 16) %>%
#   row_spec(1:nrow(regtab_ran_fun(r1_dse)), color = "black")
```

### Spiritual Events

```{r}
r1_spev <- lmer(spev_score_std ~ abs_score_std + 
                  (1 + abs_score_std || p7_ctry), d4)
summary(r1_spev)
```

```{r}
rsquared(r1_spev)
```

```{r}
regtab_fun(r1_spev) %>%
  kable(align = c(rep("r", ncol(.) - 1), "l")) %>%
  kable_styling(font_size = 16) %>%
  row_spec(2, bold = T) %>%
  row_spec(1:nrow(regtab_fun(r1_spev)), color = "black")
```

```{r}
# regtab_ran_fun(r1_spev) %>%
#   mutate(Group = case_when(is.na(Group) ~ "Participant, nested within p7_ctry",
#                            TRUE ~ as.character(Group)),
#          Group = factor(Group, levels = c("p7_ctry", 
#                                           "Participant, nested within p7_ctry", 
#                                           "Residual"))) %>%
#   arrange(Group) %>%
#   kable(align = "r") %>%
#   kable_styling(font_size = 16) %>%
#   row_spec(1:nrow(regtab_ran_fun(r1_spev)), color = "black")
```

## p7_ctry as fixed effect

### Daily Spiritual Experiences

```{r}
r2_dse <- lm(dse_score_std ~ abs_score_std * p7_ctry, d4)
summary(r2_dse)
```

```{r}
rsquared(r2_dse)
```

```{r}
regtab_fun(r2_dse) %>%
  kable(align = c(rep("r", ncol(.) - 1), "l")) %>%
  kable_styling(font_size = 16) %>%
  row_spec(2, bold = T) %>%
  row_spec(1:nrow(regtab_fun(r2_dse)), color = "black")
```


### Spiritual Events

```{r}
r2_spev <- lm(spev_score_std ~ abs_score_std * p7_ctry, d4)
summary(r2_spev)
```

```{r}
rsquared(r2_spev)
```

```{r}
regtab_fun(r2_spev) %>%
  kable(align = c(rep("r", ncol(.) - 1), "l")) %>%
  kable_styling(font_size = 16) %>%
  row_spec(2, bold = T) %>%
  row_spec(1:nrow(regtab_fun(r2_spev)), color = "black")
```



# Porosity and absorption differentially predicting individual extraordinary experiences

```{r}
d4_different <- d4 %>%
  select(p7_ctry, p7_subj, por_score_std, pv_score_std, abs_score_std) %>%
  full_join(d4_byquestion %>% 
              select(-scale) %>%
              # standardize responses by question (collapsing across countries)
              group_by(question) %>%
              mutate(response = scale(response)) %>%
              ungroup() %>%
              spread(question, response) %>%
              select(p7_subj, s4_var_dse, s4_var_spev, s4_var_hall, s4_var_para))
```

```{r}
d4_different_cor <- d4_different %>%
  select(-p7_ctry, -p7_subj) %>%
  # unite(p7_ctry.p7_subj, p7_ctry, p7_subj, sep = "_") %>%
  # column_to_rownames("p7_ctry.p7_subj") %>%
  cor(use = "pairwise.complete") %>%
  data.frame() %>%
  rownames_to_column("var1") %>%
  gather(var2, cor, -var1)
```

```{r}
d4_different_cor2 <- d4_different_cor %>%
  filter(grepl("score", var1),
         !grepl("score", var2)) %>%
  mutate(var1 = factor(
    var1, 
    levels = c("por_score_std", "pv_score_std", "abs_score_std"),
    labels = c("Porosity Scale", "Porosity Vignettes", "Absorption"))) %>%
  left_join(d4_byquestion %>% 
              distinct(scale, question), 
            by = c("var2" = "question")) %>%
  distinct() %>%
  mutate(scale = factor(
    scale,
    levels = c("dse_score", "spev_score", "hall_score", "para_score"),
    labels = c("Daily Spiritual Experiences\n(Underwood & Teresi, 2002)", 
               "Spiritual Events\n(novel measure)",
               "Hallucinations\n(Morrison et al., 2000)", 
               "Paranormal\n(Thalborne & Delin, 1993)")),
    var2_lab = factor(var2,
                      levels = c(s4_var_dse, s4_var_spev, s4_var_hall, s4_var_para),
                      labels = c(paste("Item", 1:length(s4_var_dse)),
                                 paste("Item", 1:length(s4_var_spev)),
                                 paste("Item", 1:length(s4_var_hall)),
                                 paste("Item", 1:length(s4_var_para))))) %>%
  rename(predictor = var1, experience = var2, experience_lab = var2_lab)
```

```{r}
d4_different_cor_top4 <- d4_different_cor2 %>%
  group_by(predictor) %>%
  top_n(4, cor) %>%
  arrange(predictor, desc(cor))
d4_different_cor_top4 %>% kable(digits = 2) %>% kable_styling() %>% collapse_rows(1)

d4_different_cor_top4_spev <- d4_different_cor2 %>%
  filter(grepl("Spiritual Events", scale)) %>%
  group_by(predictor) %>%
  top_n(4, cor) %>%
  arrange(predictor, desc(cor))
# d4_different_cor_top4_spev %>% kable(digits = 2) %>% kable_styling() %>% collapse_rows(1)

d4_different_cor_top4_dse <- d4_different_cor2 %>%
  filter(grepl("Daily Spiritual Experiences", scale)) %>%
  group_by(predictor) %>%
  top_n(4, cor) %>%
  arrange(predictor, desc(cor))
# d4_different_cor_top4_dse %>% kable(digits = 2) %>% kable_styling() %>% collapse_rows(1)

d4_different_cor_top4_hall <- d4_different_cor2 %>%
  filter(grepl("Hallucinations", scale)) %>%
  group_by(predictor) %>%
  top_n(4, cor) %>%
  arrange(predictor, desc(cor))
# d4_different_cor_top4_hall %>% kable(digits = 2) %>% kable_styling() %>% collapse_rows(1)

d4_different_cor_top4_para <- d4_different_cor2 %>%
  filter(grepl("Paranormal", scale)) %>%
  group_by(predictor) %>%
  top_n(4, cor) %>%
  arrange(predictor, desc(cor))
# d4_different_cor_top4_para %>% kable(digits = 2) %>% kable_styling() %>% collapse_rows(1)
```

```{r, fig.width = 2.5, fig.asp = 2.5}
d4_different_cor2 %>%
  left_join(d4_different_cor_top4 %>% mutate(top4 = "bold")) %>%
  mutate(top4 = case_when(is.na(top4) ~ "plain", TRUE ~ top4)) %>%
  ggplot(aes(x = predictor, y = reorder(experience_lab, desc(experience_lab)), 
             fill = cor, label = format(round(cor, 2), nsmall = 2))) +
  facet_grid(scale ~ ., scales = "free", space = "free") +
  geom_tile(aes(size = top4), 
            color = "black", show.legend = T) +
  geom_text(aes(fontface = top4), 
            size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1),
                       guide = guide_colorbar(barwidth = 10, barheight = 0.5)) +
  scale_size_manual(values = c(0.5, 0.05)) +
  theme_minimal() +
  theme(legend.position = "bottom") +
  labs(x = "Predictor", y = "Experience Item", fill = "Pearson's r") +
  guides(size = "none")
```

## By country, version 1 (standardized within country, correlate across)

```{r}
d4_different_bycountry <- d4 %>%
  select(p7_ctry, p7_subj, por_score_std2, pv_score_std2, abs_score_std2) %>%
  full_join(d4_byquestion %>% 
              select(-scale) %>%
              group_by(p7_ctry, question) %>%
              # standardize responses by country and question
              mutate(response = scale(response)) %>%
              spread(question, response) %>%
              select(p7_subj, s4_var_dse, s4_var_spev, s4_var_hall, s4_var_para))
```

```{r}
d4_different_bycountry_cor <- d4_different_bycountry %>%
  select(-p7_ctry, -p7_subj) %>%
  # unite(p7_ctry.p7_subj, p7_ctry, p7_subj, sep = "_") %>%
  # column_to_rownames("p7_ctry.p7_subj") %>%
  cor(use = "pairwise.complete") %>%
  data.frame() %>%
  rownames_to_column("var1") %>%
  gather(var2, cor, -var1)
```

```{r}
d4_different_bycountry_cor2 <- d4_different_bycountry_cor %>%
  filter(grepl("score", var1),
         !grepl("score", var2)) %>%
  mutate(var1 = factor(
    var1, 
    levels = c("por_score_std2", "pv_score_std2", "abs_score_std2"),
    labels = c("Porosity Scale", "Porosity Vignettes", "Absorption"))) %>%
  left_join(d4_byquestion %>% 
              distinct(scale, question), 
            by = c("var2" = "question")) %>%
  distinct() %>%
  mutate(scale = factor(
    scale,
    levels = c("dse_score", "spev_score", "hall_score", "para_score"),
    labels = c("Daily Spiritual Experiences\n(Underwood & Teresi, 2002)", 
               "Spiritual Events\n(novel measure)",
               "Hallucinations\n(Morrison et al., 2000)", 
               "Paranormal\n(Thalborne & Delin, 1993)")),
    var2_lab = factor(var2,
                      levels = c(s4_var_dse, s4_var_spev, s4_var_hall, s4_var_para),
                      labels = c(paste("Item", 1:length(s4_var_dse)),
                                 paste("Item", 1:length(s4_var_spev)),
                                 paste("Item", 1:length(s4_var_hall)),
                                 paste("Item", 1:length(s4_var_para))))) %>%
  rename(predictor = var1, experience = var2, experience_lab = var2_lab)
```

```{r}
d4_different_bycountry_cor_top4 <- d4_different_bycountry_cor2 %>%
  group_by(predictor) %>%
  top_n(4, cor) %>%
  arrange(predictor, desc(cor))

d4_different_bycountry_cor_top4_spev <- d4_different_bycountry_cor2 %>%
  filter(grepl("Spiritual Events", scale)) %>%
  group_by(predictor) %>%
  top_n(4, cor) %>%
  arrange(predictor, desc(cor))

d4_different_bycountry_cor_top4_dse <- d4_different_bycountry_cor2 %>%
  filter(grepl("Daily Spiritual Experiences", scale)) %>%
  group_by(predictor) %>%
  top_n(4, cor) %>%
  arrange(predictor, desc(cor))
```

```{r, fig.width = 2.5, fig.asp = 2.5}
d4_different_bycountry_cor2 %>%
  left_join(d4_different_bycountry_cor_top4 %>% mutate(top4 = "bold")) %>%
  mutate(top4 = case_when(is.na(top4) ~ "plain", TRUE ~ top4)) %>%
  ggplot(aes(x = predictor, y = reorder(experience_lab, desc(experience_lab)), 
             fill = cor, label = format(round(cor, 2), nsmall = 2))) +
  facet_grid(scale ~ ., scales = "free", space = "free") +
  geom_tile(aes(size = top4), 
            color = "black", show.legend = T) +
  geom_text(aes(fontface = top4), 
            size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1),
                       guide = guide_colorbar(barwidth = 10, barheight = 0.5)) +
  scale_size_manual(values = c(0.5, 0.05)) +
  theme_minimal() +
  theme(legend.position = "bottom") +
  labs(x = "Predictor", y = "Experience Item", fill = "Pearson's r") +
  guides(size = "none")
```

## By country, version 2 (standardized within country, correlate within)

```{r}
d4_different_bycountry2 <- d4 %>%
  select(p7_ctry, p7_subj, por_score_std2, pv_score_std2, abs_score_std2) %>%
  full_join(d4_byquestion %>% 
              select(-scale) %>%
              group_by(p7_ctry, question) %>%
              # standardize responses by country and question
              mutate(response = scale(response)) %>%
              ungroup() %>%
              spread(question, response) %>%
              select(p7_subj, s4_var_dse, s4_var_spev, s4_var_hall, s4_var_para))
```

```{r}
d4_different_bycountry2_cor_us <- d4_different_bycountry2 %>%
  filter(p7_ctry == "US") %>%
  select(-p7_ctry, -p7_subj) %>%
  # unite(p7_ctry.p7_subj, p7_ctry, p7_subj, sep = "_") %>%
  # column_to_rownames("p7_ctry.p7_subj") %>%
  cor(use = "pairwise.complete") %>%
  data.frame() %>%
  rownames_to_column("var1") %>%
  gather(var2, cor, -var1)

d4_different_bycountry2_cor_gh <- d4_different_bycountry2 %>%
  filter(p7_ctry == "Ghana") %>%
  select(-p7_ctry, -p7_subj) %>%
  # unite(p7_ctry.p7_subj, p7_ctry, p7_subj, sep = "_") %>%
  # column_to_rownames("p7_ctry.p7_subj") %>%
  cor(use = "pairwise.complete") %>%
  data.frame() %>%
  rownames_to_column("var1") %>%
  gather(var2, cor, -var1)

d4_different_bycountry2_cor_th <- d4_different_bycountry2 %>%
  filter(p7_ctry == "Thailand") %>%
  select(-p7_ctry, -p7_subj) %>%
  # unite(p7_ctry.p7_subj, p7_ctry, p7_subj, sep = "_") %>%
  # column_to_rownames("p7_ctry.p7_subj") %>%
  cor(use = "pairwise.complete") %>%
  data.frame() %>%
  rownames_to_column("var1") %>%
  gather(var2, cor, -var1)

d4_different_bycountry2_cor_ch <- d4_different_bycountry2 %>%
  filter(p7_ctry == "China") %>%
  select(-p7_ctry, -p7_subj) %>%
  # unite(p7_ctry.p7_subj, p7_ctry, p7_subj, sep = "_") %>%
  # column_to_rownames("p7_ctry.p7_subj") %>%
  cor(use = "pairwise.complete") %>%
  data.frame() %>%
  rownames_to_column("var1") %>%
  gather(var2, cor, -var1)

d4_different_bycountry2_cor_vt <- d4_different_bycountry2 %>%
  filter(p7_ctry == "Vanuatu") %>%
  select(-p7_ctry, -p7_subj) %>%
  # unite(p7_ctry.p7_subj, p7_ctry, p7_subj, sep = "_") %>%
  # column_to_rownames("p7_ctry.p7_subj") %>%
  cor(use = "pairwise.complete") %>%
  data.frame() %>%
  rownames_to_column("var1") %>%
  gather(var2, cor, -var1)
```

```{r}
d4_different_bycountry2_cor <- bind_rows(
  d4_different_bycountry2_cor_us %>% mutate(country = "US"),
  d4_different_bycountry2_cor_gh %>% mutate(country = "Ghana"),
  d4_different_bycountry2_cor_th %>% mutate(country = "Thailand"),
  d4_different_bycountry2_cor_ch %>% mutate(country = "China"),
  d4_different_bycountry2_cor_vt %>% mutate(country = "Vanuatu"))
```

```{r}
d4_different_bycountry2_cor2 <- d4_different_bycountry2_cor %>%
  filter(grepl("score", var1),
         !grepl("score", var2)) %>%
  mutate(country = factor(country, levels = levels_country)) %>%
  mutate(var1 = factor(
    var1, 
    levels = c("por_score_std2", "pv_score_std2", "abs_score_std2"),
    labels = c("Porosity Scale", "Porosity Vignettes", "Absorption"))) %>%
  left_join(d4_byquestion %>% 
              distinct(scale, question), 
            by = c("var2" = "question")) %>%
  distinct() %>%
  mutate(scale = factor(
    scale,
    levels = c("dse_score", "spev_score", "hall_score", "para_score"),
    labels = c("Daily Spiritual Experiences\n(Underwood & Teresi, 2002)", 
               "Spiritual Events\n(novel measure)",
               "Hallucinations\n(Morrison et al., 2000)", 
               "Paranormal\n(Thalborne & Delin, 1993)")),
    var2_lab = factor(var2,
                      levels = c(s4_var_dse, s4_var_spev, s4_var_hall, s4_var_para),
                      labels = c(paste("Item", 1:length(s4_var_dse)),
                                 paste("Item", 1:length(s4_var_spev)),
                                 paste("Item", 1:length(s4_var_hall)),
                                 paste("Item", 1:length(s4_var_para))))) %>%
  rename(predictor = var1, experience = var2, experience_lab = var2_lab)
```

```{r}
d4_different_bycountry2_cor_top4 <- d4_different_bycountry2_cor2 %>%
  group_by(predictor, country) %>%
  top_n(4, cor) %>%
  arrange(predictor, desc(cor))

d4_different_bycountry2_cor_top4_spev <- d4_different_bycountry2_cor2 %>%
  filter(grepl("Spiritual Events", scale)) %>%
  group_by(predictor, country) %>%
  top_n(4, cor) %>%
  arrange(predictor, desc(cor))

d4_different_bycountry2_cor_top4_dse <- d4_different_bycountry2_cor2 %>%
  filter(grepl("Daily Spiritual Experiences", scale)) %>%
  group_by(predictor, country) %>%
  top_n(4, cor) %>%
  arrange(predictor, desc(cor))
```

```{r, fig.width = 5, fig.asp = 1.25}
d4_different_bycountry2_cor2 %>%
  left_join(d4_different_bycountry2_cor_top4 %>% mutate(top4 = "bold")) %>%
  mutate(top4 = case_when(is.na(top4) ~ "plain", TRUE ~ top4)) %>%
  ggplot(aes(x = country, y = reorder(experience_lab, desc(experience_lab)), 
             fill = cor, label = format(round(cor, 2), nsmall = 2))) +
  facet_grid(scale ~ predictor, scales = "free", space = "free") +
  geom_tile(aes(size = top4), 
            color = "black", show.legend = T) +
  geom_text(aes(fontface = top4), 
            size = 3) +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1),
                       guide = guide_colorbar(barwidth = 10, barheight = 0.5)) +
  scale_size_manual(values = c(0.5, 0.05)) +
  theme_minimal() +
  theme(legend.position = "bottom",
        axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
  labs(x = "Country", y = "Experience Item", fill = "Pearson's r") +
  guides(size = "none")
```




